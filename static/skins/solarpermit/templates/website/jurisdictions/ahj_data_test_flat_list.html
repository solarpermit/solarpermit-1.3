{% extends "/website/jurisdictions/AHJ_data.html" %}
{% block category_content %}  


   {% for obj in objs %}
        {% set object_type = obj.get('obj_type') %}
        {% set object = obj.get('obj') %}
 
        {% if object_type == 'category' %}
            {% set this_category_current_questions = categories_current_questions.get(object.id) %}        
            {% if loop.first == False %}
                {% if empty_data_fields_hidden | int == 0 %}            
                <div id="div_custom_question_content_{{last_category.id}}"></div>
                    
                <div class="label" >Don't see the info you're looking for here?</div>
                <div >Check out the other sections to the left or create a custom field to share more info with the community.</div>            
                <div ><input type="button"  id="create_custom_field_btn_{{last_category.id}}"  name="create_custom_field_btn" value="Create a custom field..." class="smallbutton create_custom_field_btn" data-jurisdiction_id='{{jurisdiction.id}}' data-category_id='{{last_category.id}}' data-current_category='{{category}}'  data-current_questions='{{this_category_current_questions | join(',') }}' ></div>            
                <div style="margin:10px;width:100%">&nbsp;</div>
                {% endif %}            
            {% endif %}
            {% set last_category = object %}
            <div class="ahj_category_header" style="width:100%;float:left;" >{{object.description | capitalize }}</div>        


            
        {% elif object_type == 'question' %}
            {% set this_question = object %}
            {% set has_answers = obj.get('has_answers') %}
            {% set login_user_suggested_a_value = questions_login_user_suggested_a_value.get(this_question.id) %}   
            {% set pending_editable_answer_ids_array = questions_pending_editable_answer_ids_array.get(this_question.id) %}                   
            {% if login_user_suggested_a_value == True %}
                {% set icon = 'Y' %}
                {% set label_tooltip = 'Sorry, you have already provided an answer.' %}
            {% else %}
                {% set icon = 'N' %}
                {% set label_tooltip = '' %}
            {% endif %}            
            {% set terminology = object.get_terminology() %}
            <div class="ahj_general" style="width:580px" id="div_question_content_{{this_question.id}}">
                <div class="qasv_content need_tooltip" style="width:100%;float:left;" id="child_of_div_{{object.id}}" data-id="{{object.id}}" data-paids="" data-jurid="{{jurisdiction.id}}">            
                    <div class="label"  title="{{terminology}}" data-icon="{{icon}}" data-icon="{{label_tooltip}}" {% if login_user_suggested_a_value == False or login_user_suggested_a_value == None %}onClick="controller.suggestionField.clickAddLabel({{jurisdiction.id}}, {{this_question.id}});" {% endif %}>
                        <span style="float:left;visibility:visible;display:none;padding-right:5px" id="edit_question_{{object.id}}"   ><img width="10" src="/media/images/edit.png" alt="edit" ></span>
                        <span style="float:left;" >{{object.get_field_label(jurisdiction) | capitalize }}</span>        
                        <span id="q_actions_{{object.id}}">
                            {% include 'website/jurisdictions/ahj_actions.html' %}
                        </span>
                    </div>
                </div>
            {% if object.description != None and object.description != '' %}                
                <div class="description" style="width:100%;float:left;padding-left:25px">
                    {{object.description}}
                </div>        
            {% endif %}
            </div>
            
            {% if login_user_suggested_a_value == False or login_user_suggested_a_value == None %}

            <div id="qa_{{object.id}}_add" class="cssCell suggestion_edit_box" style="display:none">                     
                <form id="form_{{this_question.id}}" name="name_{{object.id}}" action="."  method="post" accept-charset="utf-8">
                    <input type="hidden" name="ajax" value="suggestion_submit" />
                    <input type="hidden" name="jurisdiction_id" value="{{jurisdiction.id}}" />
                    <input type="hidden" name="question_id" value="{{object.id}}" />                     
                              
                    <div id="qa_{{object.id}}_fields"></div>
                    <div>
                        <input type="submit" name="save_{{object.id}}" value="Save" id="save_{{object.id}}"  class="smallbutton" title="" >
                        <input type="button" name="Cancel" value="Cancel" id="cancel_{{object.id}}" class="smallbutton" onClick="controller.closeSuggestion('{{object.id}}');"  title="" >
                    </div>
                </form>                                                
            </div>
  
            {% endif %}  
            
            {% if view == True or (view == False and empty_data_fields_hidden | int == 0 and has_answers == False) or (view == False and empty_data_fields_hidden == 1  and has_answers == False ) %} 
            <div class="prompt" id="q_no_data_{{this_question.id}}" style="padding-left:25px">
                No info available yet...
            </div>        
            {% endif %}                          
                                                 

        {% elif object_type == 'answer' %}
            {% set this_answer = object %}
            {% set answer_content = answers_contents.get(this_answer.id) %}         
            <div style="padding:0px 5px 10px 25px;">
                <div class="cssTable" style="margin-bottom:10px">
                    <div class="cssRow">
                        <div class="cssCell suggestion_left" >            
                            <div class="suggestion_header" id="suggestion_header_{{this_answer.id}}" style="display:none"></div>
                                                                        
                            <div class="field answer_field" id="{{this_answer.id}}" {% if this_answer.id in pending_editable_answer_ids_array %}onmouseover="controller.initSuggestionFieldEvent(this);"{% endif %} >
                                {% if this_answer.id in pending_editable_answer_ids_array %}
                                <span  class="cancel_btn" id="cancel_btn_{{this_answer.id}}" title="Cancel your message" style="width:22px;float:left;" >
                                    <input  class="cancelbt field_mo_l3 cancel_this_value" type="button"   value="" data-id="{{this_answer.id}}" >
                                </span>
                                                        
                                <span class="edit_btn" id="edit_btn_{{this_answer.id}}" title = "Edit your suggestion" style="width:35px;float:left" >
                                    <input class="editbt canedit field_mo_l1 edit_this_value" id="edit_button_{{this_answer.id}}" type="button"  value="" data-id="{{this_answer.id}}" data-terminology="{{terminology}}" data-jurid="{{jurisdiction.id}}" data-qid="{{this_question.id}}"  > 
                                </span>
                                {% endif %}                        
                        
                        
                        
                            {% if this_question.display_template == '' or this_question.display_template == None %}
                                {% if answer_content.get('free-form') != None and answer_content.get('free-form') != '' %} 
                                        {{answer_content.get('free-form') | replace('\n', '<br/>')}}
                        
                                {% else %}
                
                                {% if answer_content.get('value') != None %}
                                     {{answer_content.get('value') | replace('\n', '<br/>') | capitalize }}
                                     {% if this_question.field_suffix != None %}
                                     {{this_question.field_suffix}}
                                     {% endif %}
                                {% endif %}                
                
                    
                                {% endif %}        
                            {% else %}
                                {% set template = 'website/jurisdictions/suggestion_display_template/'+this_question.display_template %}
                                {% include template %}
                            {% endif %} 
            
                            {% if this_question.support_attachments | int == 1 %}
                                <div id='attachment_{{this_answer.id}}' style="display:none"></div>                     
                            {% endif %}              
                            </div>
                            
                            {% if this_answer.approval_status == 'A' %}
                                <div class="valhis">
                                    <div id="validation_history_div_{{this_answer.id}}" style="display:none;"></div>
                                        <a class="comments need_history need_history_dialog" data-id="{{this_answer.id}}" id="validation_history_{{this_answer.id}}" href="javascript:void(0);" title="" >Validation history</a> - 
                                        <a class="comments need_comment" href="#" data-id="{{this_answer.id}}" data-jid="{{jurisdiction.id}}">
                                            <span id="answer_comment_{{this_answer.id}}"></span>
                                        </a>                                    
                                    </div>  
                            {% else %}                    
                                    <div class="valhis">
                                        <a href="#" class="comments need_comment" data-id="{{this_answer.id}}" data-jid="{{jurisdiction.id}}">
                                            <span id="answer_comment_{{this_answer.id}}"></span>
                                        </a>
                                    </div>
                            {% endif %}                               
                            
                            {% if this_answer.creator_id == user.id and (this_answer.approval_status == 'P') %}
                            <div id="qa_answer_{{this_answer.id}}_edit" class="suggestion_edit_box" style="display:none">
                                <form  id="form_edit_{{this_answer.id}}" name="name_edit_{{this_answer.id}}" action="."  method="post" accept-charset="utf-8" >
                                    <input type="hidden" name="ajax" value="suggestion_edit_submit" />
                                    <input type="hidden" name="jurisdiction_id" value="{{jurisdiction.id}}" />
                                    <input type="hidden" name="question_id" value="{{this_question.id}}" /> 
                                    <input type="hidden" name="answer_id" value="{{this_answer.id}}" />                          
                                                  
                                    <div id="qa_{{this_answer.id}}_edit_fields"></div>
                                    <div>
                                        <input type="submit" name="save_edit_{{this_answer.id}}" value="Save" id="save_edit_{{this_answer.id}}"  class="smallbutton" title="" >
                                        <input type="button" name="Cancel cancelEdit" value="Cancel" id="cancel_edit_{{this_answer.id}}" class="smallbutton" onClick="controller.closeSuggestionEditAnswer('{{this_answer.id}}');" title="" >
                                    </div>
                                </form>                            
                            </div>
                            {% endif %}                            
                            
                        </div>
                        
                        
                        
                        
                        
                        <div class="csscell suggestion_right" >
                            {% include 'website/jurisdictions/ahj_answer_votes.html' %}
                            {% if user.is_superuser == 1 and this_answer.approval_status != 'A' %}
                            <div>
                                <input id="approve_this_value_{{this_answer.id}}" type="button" class="smallbutton approve_this_value" value="Approve this {{terminology}}" data-id="{{this_answer.id}}" data-terminology="{{terminology}}" >
                            </div>
                            {% endif %}                                        
                        </div>
                    </div>
                </div>
            </div>

        {% endif %}         

        {% if loop.last == True %}
            {% if empty_data_fields_hidden | int == 0 %}            
            <div id="div_custom_question_content_{{last_category.id}}"></div>
                    
            <div class="label" >Don't see the info you're looking for here?</div>
            <div >Check out the other sections to the left or create a custom field to share more info with the community.</div>            
            <div ><input type="button"  id="create_custom_field_btn_{{last_category.id}}"  name="create_custom_field_btn" value="Create a custom field..." class="smallbutton create_custom_field_btn" data-jurisdiction_id='{{jurisdiction.id}}' data-category_id='{{last_category.id}}' data-current_category='{{category}}'  data-current_questions='{{this_category_current_questions | join(',') }}' ></div>            
            
            {% endif %}            
        {% endif %} 
   {% endfor %}
   
    {% for item in time %}
        <div>{{item}}</div>
    {% endfor %}   
{% endblock %}





